/**
 * Ragi CSS - Typography Layer
 * Fluid typography using clamp() with modular scale
 * Week 2
 */

@layer base {
  /* ============================================
   * Body Text
   * ============================================ */

  :where(body) {
    font-family: var(--font-sans);
    font-size: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);
    line-height: var(--line-height-normal);
    color: var(--color-text);
    background: var(--color-bg);
    font-weight: var(--font-weight-normal);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  /* ============================================
   * Headings
   * Tighter tracking for premium feel
   * ============================================ */

  :where(h1, h2, h3, h4, h5, h6) {
    line-height: var(--line-height-tight);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    margin-block-end: 0.6em;
    letter-spacing: -0.025em;

    /* Remove top margin when heading follows another element */
    & + * {
      margin-block-start: 0;
    }
  }

  :where(h1) {
    font-size: clamp(2.25rem, 1.8rem + 2.5vw, 3.5rem);
    font-weight: 800;
    letter-spacing: -0.03em;
  }

  :where(h2) {
    font-size: clamp(1.75rem, 1.5rem + 1.5vw, 2.5rem);
    font-weight: 700;
  }

  :where(h3) {
    font-size: clamp(1.35rem, 1.2rem + 1vw, 2rem);
    font-weight: 600;
  }

  :where(h4) {
    font-size: clamp(1.15rem, 1.1rem + 0.5vw, 1.5rem);
    font-weight: 600;
  }

  :where(h5) {
    font-size: 1rem;
    font-weight: 600;
  }

  :where(h6) {
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
  }

  /* ============================================
   * Paragraphs
   * ============================================ */

  :where(p) {
    margin-block: 1.25em;
    max-width: 65ch; /* Optimal reading length */
  }

  /* Lead paragraph (first paragraph after heading) */
  :where(h1, h2) + p {
    font-size: 1.15em;
    line-height: 1.6;
    color: var(--color-text-muted);
    max-width: 60ch;
  }

  /* ============================================
   * Links
   * ============================================ */

  :where(a) {
    color: inherit;
    text-decoration: underline;
    text-decoration-color: var(--color-border);
    text-decoration-thickness: 1px;
    text-underline-offset: 4px;
    transition: all var(--transition-fast);

    &:hover {
      color: var(--color-primary);
      text-decoration-color: var(--color-primary);
    }

    &:focus-visible {
      outline: 2px solid var(--color-primary);
      outline-offset: 2px;
      border-radius: 2px;
      text-decoration: none;
    }
  }

  /* Links inside headings */
  :where(h1, h2, h3, h4, h5, h6) a {
    text-decoration: none;

    &:hover {
      text-decoration: underline;
      text-decoration-color: currentColor;
    }
  }

  /* ============================================
   * Lists
   * ============================================ */

  :where(ul, ol) {
    padding-inline-start: 1.5em;
    margin-block: 1.25em;
    color: var(--color-text);

    & li {
      margin-block: 0.5em;
      padding-inline-start: 0.25em;

      &::marker {
        color: var(--color-text-muted);
      }

      /* Nested lists */
      & :where(ul, ol) {
        margin-block: 0.5em;
      }
    }
  }

  /* Unordered lists */
  :where(ul) {
    list-style-type: disc;
  }

  /* Ordered lists */
  :where(ol) {
    list-style-type: decimal;
  }

  /* Description lists */
  :where(dl) {
    margin-block: 1.5em;

    & dt {
      font-weight: var(--font-weight-semibold);
      margin-block-start: 1em;
      color: var(--color-text);
    }

    & dd {
      margin-inline-start: 0;
      margin-block-start: 0.25em;
      color: var(--color-text-muted);
      line-height: 1.6;
    }
  }

  /* ============================================
   * Inline Text Elements
   * ============================================ */

  :where(strong, b) {
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
  }

  :where(em, i) {
    font-style: italic;
  }

  :where(small) {
    font-size: 0.875em;
  }

  :where(mark) {
    background: var(--color-warning-bg);
    color: var(--color-text);
    padding: 0 0.25em;
    border-radius: var(--radius-sm);
  }

  :where(del, s) {
    text-decoration: line-through;
    opacity: 0.7;
  }

  :where(ins) {
    text-decoration: none;
    border-bottom: 2px solid var(--color-success);
    background: var(--color-success-bg);
  }

  :where(sub, sup) {
    font-size: 0.75em;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }

  :where(sub) {
    bottom: -0.25em;
  }

  :where(sup) {
    top: -0.5em;
  }

  :where(abbr[title]) {
    text-decoration: underline dotted;
    text-underline-offset: 4px;
    cursor: help;
  }

  /* ============================================
   * Code
   * ============================================ */

  :where(code, kbd, samp, var) {
    font-family: var(--font-mono);
    font-size: 0.85em;
  }

  /* Inline code */
  :where(code) {
    padding: 0.2em 0.4em;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    color: var(--color-text);
    white-space: nowrap;
  }

  /* Keyboard input */
  :where(kbd) {
    padding: 0.1em 0.4em;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-bottom-width: 2px;
    border-radius: var(--radius-sm);
    font-size: 0.8em;
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
    box-shadow: 0 1px 1px rgba(0,0,0,0.05);
  }

  /* Code blocks */
  :where(pre) {
    overflow-x: auto;
    padding: var(--space-lg);
    background: #0f172a; /* Always dark for code blocks */
    color: #f8fafc;
    border-radius: var(--radius-lg);
    margin-block: 2em;
    line-height: 1.7;
    box-shadow: var(--shadow-md);

    & code {
      padding: 0;
      background: none;
      border: none;
      color: inherit;
      white-space: pre;
    }
  }

  /* ============================================
   * Blockquotes
   * ============================================ */

  :where(blockquote) {
    margin-block: 2em;
    margin-inline: 0;
    padding-inline-start: 1.5em;
    border-inline-start: 3px solid var(--color-primary);
    
    & p {
      font-size: 1.1em;
      font-style: italic;
      color: var(--color-text);
      font-weight: var(--font-weight-medium);
    }

    & cite {
      display: block;
      margin-block-start: 0.5em;
      font-style: normal;
      font-size: 0.875em;
      color: var(--color-text-muted);
      font-weight: var(--font-weight-semibold);

      &::before {
        content: 'â€” ';
      }
    }
  }

  /* ============================================
   * Horizontal Rule
   * ============================================ */

  :where(hr) {
    border: none;
    border-block-start: 1px solid var(--color-border);
    margin-block: 3em;
    opacity: 0.6;
  }

  /* ============================================
   * Figures
   * ============================================ */

  :where(figure) {
    margin-inline: 0;
    margin-block: 2em;

    & figcaption {
      margin-block-start: 0.75em;
      font-size: 0.875em;
      color: var(--color-text-muted);
      text-align: center;
    }
  }
}
